<!doctype html><meta charset="utf-8"><title>Send Update Test</title>
<body style="font-family:system-ui;margin:20px;">
<h2>Send Update — Direct Test</h2>
<label>Recipient: <input id="to" style="width:320px" placeholder="you@example.com"></label><br><br>
<label>Week Key: <input id="wk" style="width:180px" value="test-"></label><br><br>
<label>Note:<br><textarea id="note" style="width:420px;height:90px">diagnostic</textarea></label><br><br>
<button id="go">Send</button>
<pre id="out" style="background:#f6f8fa;padding:12px;border:1px solid #ddd;white-space:pre-wrap;margin-top:12px;"></pre>
<script>
document.getElementById('wk').value = 'test-' + Date.now();
document.getElementById('go').onclick = async ()=>{
  const out = document.getElementById('out');
  out.textContent = 'Sending…';
  const body = {
    weekKey: document.getElementById('wk').value.trim(),
    to: [document.getElementById('to').value.trim()].filter(Boolean),
    note: document.getElementById('note').value
  };
  const res = await fetch('/.netlify/functions/send-update', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    credentials:'include',
    body: JSON.stringify(body)
  });
  const text = await res.text().catch(()=> '');
  out.textContent = `STATUS ${res.status}\n` + text;
};
</script>
</body>
